<IfModule mod_ssl.c>
    <VirtualHost _default_:443>
        ServerAdmin webmaster@localhost
        ServerName vulnerable.local
        DocumentRoot /var/www/html

        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined

        # Enable SSL
        SSLEngine on

        # VULNERABLE CONFIGURATION - Enable ONLY SSLv3
        # This is the core vulnerability for POODLE attack
        SSLProtocol -all +SSLv3

        # Use CBC ciphers (required for POODLE)
        # These ciphers are vulnerable when used with SSLv3
        SSLCipherSuite HIGH:MEDIUM:+3DES:!aNULL:!MD5:!RC4
        SSLHonorCipherOrder on

        # SSL Certificate paths
        SSLCertificateFile /etc/apache2/ssl/apache.crt
        SSLCertificateKeyFile /etc/apache2/ssl/apache.key

        # Enable SSL for PHP files
        <FilesMatch "\.(cgi|shtml|phtml|php)$">
            SSLOptions +StdEnvVars
        </FilesMatch>

        <Directory /var/www/html>
            Options Indexes FollowSymLinks
            AllowOverride All
            Require all granted
            DirectoryIndex index.php index.html

            # Ensure PHP files are processed
            <IfModule mod_php5.c>
                AddType application/x-httpd-php .php
            </IfModule>
        </Directory>

    </VirtualHost>
</IfModule>
